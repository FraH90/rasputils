# Update system
sudo apt update && sudo apt upgrade -y

# Clone GCM repository
git clone https://github.com/GitCredentialManager/git-credential-manager.git
cd git-credential-manager

# Build Git Credential Manager
dotnet build src/shared/Git-Credential-Manager/ -c Release -p:PublishSingleFile=true --self-contained true -r linux-arm64 -p:PublishTrimmed=false

# Install from source
cd /src/linux/Packaging.Linux
chmod +x install-from-source.sh
sudo ./install-from-source.sh

# Configure git to work with git credential manager as default credential helper
git config --global credential.helper manager-core

# Configure for specific services (GitHub, Azure, BitBucket)
git config --global credential.https://github.com.useHttpPath true
git config --global credential.https://dev.azure.com.useHttpPath true
git config --global credential.https://bitbucket.org.useHttpPath true
